<br/>
<div class="transactions-container">
  <header class="header">
    <div class="header-content">
      <h1>Hello {{ userService.user.username}},</h1>
      <div class="flex justify-content-between align-items-center">
        <p>Your Available Balance</p>
        <h2><b>{{ userService.totalBalance | currency: 'XAF' }}</b> </h2>
      </div>
    </div>
  </header>
  <div class="navigation">
    <div class="nav-item"> <mat-icon (click)="openBottomSheet('withdraw')">currency_exchange</mat-icon> <p>Withdraw</p></div>
    <div class="nav-item"> <mat-icon (click)="openBottomSheet('deposit')">account_balance_wallet</mat-icon> <p>Deposit</p> </div>
    <div class="nav-item"> <mat-icon (click)="reloadPage()">history</mat-icon><p>Refresh</p> </div>
  </div>
  <mat-tab-group>
    <mat-tab label="Tickets">
      <div class="transactions-header">
        <div class="filters">
          <mat-form-field appearance="outline">
            <mat-label>Bet type</mat-label>
            <mat-select [(value)]="selectedBetType">
              <mat-option value="all">All</mat-option>
              <mat-option value="open">Open</mat-option>
              <mat-option value="won">Won</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Period</mat-label>
            <mat-select [(value)]="selectedPeriod">
              <mat-option value="lastTwoWeeks">Last two weeks</mat-option>
              <mat-option value="lastMonth">Last month</mat-option>
            </mat-select>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Range: Start</mat-label>
            <input matInput [matDatepicker]="startDatePicker" [(ngModel)]="startDate">
            <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #startDatePicker></mat-datepicker>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>End</mat-label>
            <input matInput [matDatepicker]="endDatePicker" [(ngModel)]="endDate">
            <mat-datepicker-toggle matSuffix [for]="endDatePicker"></mat-datepicker-toggle>
            <mat-datepicker #endDatePicker></mat-datepicker>
          </mat-form-field>

          <button mat-raised-button color="primary w-full" (click)="searchTransaction()">SEARCH</button>
        </div>
      </div>

      <mat-divider></mat-divider>

      <mat-card *ngIf="{transactions: (transactions$ | async)} as transactions">
        <mat-table [dataSource]="transactions?.transactions?.data || []" class="bills-table">

          <!-- Prediction Date Column -->
          <ng-container matColumnDef="createdAt">
            <mat-header-cell *matHeaderCellDef class="expand-header"> date </mat-header-cell>
            <mat-cell *matCellDef="let element"> {{element.createdAt | date: 'short' }} </mat-cell>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <mat-header-cell *matHeaderCellDef> Status </mat-header-cell>
            <mat-cell *matCellDef="let element">
              <span class="status">{{element.status}}</span>
            </mat-cell>
          </ng-container>

          <!-- Amount Column -->
          <ng-container matColumnDef="finalWinnings">
            <mat-header-cell *matHeaderCellDef> Amount </mat-header-cell>
            <mat-cell *matCellDef="let element">
              {{element.amount | currency:'XAF'}}
              <button mat-icon-button class="chat-icon" routerLink="/contact">
                <mat-icon>chat</mat-icon>
              </button>
            </mat-cell>
          </ng-container>

          <!-- Expand Row Column -->
          <ng-container matColumnDef="expand">
            <mat-header-cell *matHeaderCellDef></mat-header-cell>
            <mat-cell *matCellDef="let element">
              <button mat-icon-button>
                <mat-icon>chevron_right</mat-icon>
              </button>
            </mat-cell>
          </ng-container>

          <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
          <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
        </mat-table>
        <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                       [showFirstLastButtons]="showFirstLastButtons"
                       [length]="transactions?.transactions?.page?.totalElements || 0"
                       [pageSize]="pageSize"
                       [pageIndex]="pageIndex"
                       (page)="handlePageEvent($event)"
                       aria-label="Select page of transaction history">
        </mat-paginator>
      </mat-card>

    </mat-tab>
    <mat-tab label="Deposits"> Deposits </mat-tab>
    <mat-tab label="Withdrawals"> Withdrawals</mat-tab>
  </mat-tab-group>

</div>
